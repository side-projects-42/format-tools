var previouskey,toolstype="json",isFullScreen=!1,userId=0;function preInitEditors(){var e=null;if("json"==toolstype)createJsonEditor(),cleanJSONEditor("all"),e=getFromLocalStorage(),setDataInInputEditor(e);else if("xml"==toolstype||"xml-viewer"==toolstype)createXMLEditor();else if("yaml"==toolstype)createYAMLEditor();else if("html"==toolstype)createHTMLEditor();else if("escaper"==toolstype)createEscaperEditor();else if("encoder"==toolstype)createEncoderEditor();else if("jsontree"==toolstype)createJsonTreeEditor();else if("excel"==toolstype)createExcelOutputEditor();else if("css"==toolstype)createCSSEditor();else if("langconvert"==toolstype)createDatatoLangEditor();else if("json5"==toolstype)createJSON5Editor();else if("prettier"==toolstype)createPrettierEditor();else if("csv"==toolstype)createCSVEditor();else{if("samples"!=toolstype)return;createSampleEditor()}}function postInitEditors(){$(document).ajaxSend((function(e,t,o){$("#pluswrap").removeClass("hide")})),$(document).ajaxComplete((function(e,t,o){$("#pluswrap").addClass("hide")})),isDataUrlAvailable(),handleCtrlV(),checkIfUserLoggedinlogin(),$("#fileopen").click((function(){openFile()})),$("#default_file").change((function(){formdata=new FormData,$(this).prop("files").length>0&&(file=$(this).prop("files")[0],formdata.append("userfile",file),readSelectedFile())}))}function checkIfUserLoggedinlogin(){var e=getCookie("loggedinuser");""!=e?(userId=getCookie("loggedinuserid"),$("#loggedUserName").text(e),$("#loginDropdown").show(),$("#loginDiv").hide()):($("#loginDropdown").hide(),$("#loginDiv").show(),userId=0)}function getCookie(e){for(var t=e+"=",o=document.cookie.split(";"),a=0;a<o.length;a++){for(var l=o[a];" "==l.charAt(0);)l=l.substring(1);if(0==l.indexOf(t))return(t=l.substring(t.length,l.length)).replace(/\+/g," ")}return""}function defaultAction(){$("#defaultaction").click()}function preLogin(){storePreviousPageURL(),window.open("/login","_self")}function storePreviousPageURL(){localStorage&&localStorage.setItem("urlBeforeLogin",window.location.pathname)}function preLogout(){storePreviousPageURL(),window.open("/logout","_self")}function postLoginLogout(){var e=window.location.pathname;if(localStorage){var t=localStorage.getItem("urlBeforeLogin");t&&e!==t&&window.open(t,"_self")}}function isAceEditor(e){return $(e.container).hasClass("ace_editor")}function getOverlayClass(e){return isAceEditor(e)?"overlayaceeditor":void 0!==e&&e instanceof JSONEditor?"overlayjsoneditor":void 0}function addOverlay(e){if("input"==e){$("#inputdiv").addClass("overlay"),$("#inputFullScreen").hide(),$("#inputCloseScreen").show(),fullscreenEditor="input",$("#inputeditor").addClass(getOverlayClass(inputEditor));try{inputEditor.resize()}catch(e){}}else if("output"==e){$("#outputdiv").addClass("overlay"),$("#outputFullScreen").hide(),$("#outputCloseScreen").show(),fullscreenEditor="output",$("#outputeditor").addClass(getOverlayClass(outputEditor));try{outputEditor.resize()}catch(e){}}isFullScreen=!0,$("body").css("overflow","hidden")}function removeOverlay(e){if("input"==e){$("#inputdiv").removeClass("overlay"),$("#inputFullScreen").show(),$("#inputCloseScreen").hide(),$("#inputeditor").removeClass(getOverlayClass(inputEditor));try{inputEditor.resize()}catch(e){}}else if("output"==e){$("#outputdiv").removeClass("overlay"),$("#outputFullScreen").show(),$("#outputCloseScreen").hide(),$("#outputeditor").removeClass(getOverlayClass(outputEditor));try{outputEditor.resize()}catch(e){}}$("body").css("overflow",""),isFullScreen=!1}function updateFullScreenIcons(e){isFullScreen?"input"==e?($("#inputFullScreen").hide(),$("#inputCloseScreen").show(),fullscreenEditor="input"):"output"==e&&($("#outputFullScreen").hide(),$("#outputCloseScreen").show(),fullscreenEditor="output"):"input"==e?($("#inputFullScreen").show(),$("#inputCloseScreen").hide()):"output"==e&&($("#outputFullScreen").show(),$("#outputCloseScreen").hide())}function getCookie(e){for(var t=e+"=",o=document.cookie.split(";"),a=0;a<o.length;a++){for(var l=o[a];" "==l.charAt(0);)l=l.substring(1);if(0==l.indexOf(t))return(t=l.substring(t.length,l.length)).replace(/\+/g," ")}return""}function copyToClipboard(e){var t=$("<textarea>");$("body").append(t),t.val(e).select(),document.execCommand("copy"),t.remove(),$("#flymessage").toggleClass("in"),setTimeout((function(){$("#flymessage").removeClass("in")}),2e3)}function setMessage(e,t,o){void 0===o&&(o=!0),$("#msgDiv").html("");var a="";a="success"==e?"/"==window.location.pathname?'<div class="alert alert-info" style="margin-top: 0px;margin-bottom: 5px;">':'<div class="alert alert-info" >':'<div class="alert alert-danger" >',a+='<a href="#" class="close" data-dismiss="alert" aria-label="close" id="errorClose">&times;</a>',a+="<label>"+t+"</label></div>",$("#msgDiv").html(a),o&&setTimeout((function(){$("#errorClose").click()}),3e3)}function decodeSpecialCharacter(e){return e.replace(/\&amp;/g,"&").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/\&quot;/g,'"')}function setModelTitle(e){"Formatted JSON"==e?addOutputIconstoEditor(!0):addOutputIconstoEditor()}function hideMessage(){$("#msgDiv").html(""),$("#outputeditor .menu").show()}function loadUrl(){var e=$("#path").val();e.trim().length>5&&($("#loadFileClose").click(),load(e))}function load(e){$.ajax({type:"post",url:"//codebeautify.com/URLService",dataType:"text",data:{path:e},success:function(e){null!=e&&null!=e&&0!=e.trim().length&&setExternalURLData(e)},error:function(e,t,o){setMessage("error","Failed to load data="+t),cleanJSONEditor("all")}})}function getDataFromUrlId(e){$.ajax({type:"post",url:"/service/getDataFromID",dataType:"json",data:{urlid:e,toolstype:toolstype},success:function(e){null!=e&&null!=e&&0!=e.length?setDataView(e):alert("This URL does not Exist.")},error:function(e,t,o){setMessage("error","Failed to load data="+o),cleanJSONEditor("editor"),cleanJSONEditor()}})}function setExternalURLData(e){"json"==toolstype?setJSONDataFromResponse(e):"xml"==toolstype?setXMLDataFromResponse(e):"yaml"==toolstype?yamlInputeditor.setValue(e):inputEditor.setValue(e)}function setDataView(e){$("#title").val(e.title),$("#tags").val(e.tags),$("#desc").val(e.desc),"json"==toolstype?setJSONDataFromResponse(e.content,e.lastaction):"xml"==toolstype?setXMLDataFromResponse(e.content,e.lastaction):"yaml"==toolstype?yamlInputeditor.setValue(e.content):inputEditor.setValue(e.content),userId=e.user_id,$("#id").val(e.id)}function setJSONDataFromResponse(e,t){try{var o=$.parseJSON(e);inputEditor.setText(JSON.stringify(o,null,2)),null!=t?updateJSONOutput(t):defaultAction()}catch(t){setMessage("error","Invalid JSON Data: "+t),inputEditor.setText(e)}}function setXMLDataFromResponse(e,t){try{inputEditor.setValue(e),null!=t?updateXMLOutput(t):defaultAction()}catch(e){setMessage("error","Invalid XML Data: "+e)}}function openFile(){$("input[type=file]").click()}function readSelectedFile(){$("#loadFileClose").click();$("#viewname").val();var e="/service/uploadFile";"excel-to-html"==$("#viewname").val()&&(e="SheetReader/uploadFile"),$.ajax({url:e,type:"POST",data:formdata,processData:!1,contentType:!1,success:function(e){"error"!=e?"excel-to-html"==$("#viewname").val()?converExcelToHtml(e):(setDataInInputEditor(e),defaultAction()):setMessage("error","Error in Loading File.")}})}function download(){var e=outputEditor.getText();if(0!=e.trim().length){if("function"!=typeof saveAs)return void $.loadScript("dist/js/vendor/FileSaver.min.js",download);var t=outputEditor.getMode();if("tree"===t||"form"===t||"view"===t){var o=$.parseJSON(e);e=JSON.stringify(o,null,2)}var a=new Blob([""+e],{type:"text/plain;charset=utf-8"});filename="jsonformatter.txt","jsonToxml"==last_action&&(filename="jsonformatter.xml"),saveAs(a,filename)}else setMessage("error","Sorry Result is Empty")}function clearInput(e){"saveDialog"==e?($("#desc").val(""),$("#title").val(""),$("#tags").val("")):$("#path").val("")}function handleCtrlV(){$(document).keyup((function(e){e.ctrlKey&&86==e.keyCode||17==previouskey&&86==e.keyCode?(defaultAction(),previouskey=-1):previouskey=e.keyCode}))}function Action_Save(){if(0==("xml"==toolstype?inputEditor.getValue():"yaml"==toolstype?yamlInputeditor.getValue():"html"==toolstype?inputEditor.getValue():inputEditor.getText()).trim().length)showErrorDialog("Sorry,Input is Empty");else{var e=$("#dataUrl").val();0!=userId&&0!=e.trim().length?$("#btnUpdate").show():($("#btnUpdate").hide(),clearInput("saveDialog")),$("#openSave").click()}}function save(e){var t,o=$("#title").val();null!=o&&0!=o.length?($("#loadSaveClose").click(),t="xml"==toolstype?inputEditor.getValue():"yaml"==toolstype?yamlInputeditor.getValue():"html"==toolstype?inputEditor.getValue():inputEditor.getText(),$.ajax({url:"/service/save",dataType:"text",type:"post",async:!1,data:{content:t,title:$("#title").val(),id:$("#id").val(),user_id:userId,desc:$("#desc").val(),tags:$("#tags").val().trim(),viewname:$("#viewname").val().trim(),expirytime:$("#expiryTime").val().trim(),lastaction:last_action,toolstype:toolstype},success:function(t){if("error"!=t){var o=null;setMessage("success","Data saved successfully - <a class='white' href ='"+(o="index"==$("#viewname").val().trim()?"https://"+location.host+"/"+t:"https://"+location.host+"/"+$("#viewname").val().trim()+"/"+t)+"'>"+o+"</a>",!1),null!=e&&shareLink(o)}else alert("Please validate the input and try again.")},error:function(e,t,o){setMessage("error","Error in data saving")}})):alert("Title is required")}function update(){var e;$("#loadSaveClose").click(),e="xml"==toolstype?inputEditor.getValue():"yaml"==toolstype?yamlInputeditor.getValue():"html"==toolstype?inputEditor.getValue():inputEditor.getText(),$.ajax({url:"/service/update",dataType:"text",type:"post",data:{id:$("#id").val(),content:e,title:$("#title").val(),desc:$("#desc").val(),tags:$("#tags").val().trim()},success:function(e){setMessage("success","Data updatd successfully")},error:function(e,t,o){setMessage("error","Error in data updating")}})}function shareLink(e){"google"==getProvider()?window.open("https://plus.google.com/share?url="+e,"_blank"):window.open("https://www.facebook.com/share.php?u="+e,"_blank")}$((function(){if($(window).scrollTop(0),"recentLinks"==(toolstype=$("#type").val().trim())){var e=$("#clickedLink").val()+"Link";$("#linkDiv a.disabled").removeClass("disabled").addClass("active"),$("#linkDiv a#"+e).removeClass("active").addClass("disabled")}0!=$("#inputeditor").length&&preInitEditors()})),jQuery.loadScript=function(e,t){$.ajaxSetup({cache:!0}),jQuery.ajax({url:e,dataType:"script",success:t,async:!0}),$.ajaxSetup({cache:!1})},$(document).keyup((function(e){27==e.keyCode&&removeOverlay(fullscreenEditor)})),$(".navbar-collapse ul li a").click((function(){$(".navbar-toggle:visible").click()}));var old,online=function(e){var t=(new Date).getTime()/1e3;return e&&e.access_token&&e.expires>t};function isDataUrlAvailable(){if(0!=$("#dataUrl").length){var e=$("#dataUrl").val();0!=e.trim().length&&(6==e.trim().length?getDataFromUrlId(e):load(e))}}function saveToLocalStorage(e){localStorage&&(localStorage.setItem($("#viewname").val(),""),localStorage.setItem($("#viewname").val(),e))}function getFromLocalStorage(){if(localStorage){var e=localStorage.getItem($("#viewname").val());if(null!=e&&"URL is not valid."!=e)return e}return""}function showErrorDialog(e){$("#errorMsg").text(e),$("#openError").click()}function htmlOutput(e){var t=e;if(void 0===e&&(t="html-editor"==$("#viewname").val()?$("#summernote").summernote("code"):inputEditor.getValue()),t.trim().length>0){var o=document.getElementById("result1").contentWindow.document;old!=t&&(old=t,o.open(),o.write(old),o.close()),$("html, body").animate({scrollTop:0},10)}}function getCSVTOTSV(e){return e.split(",").join("\t")}function toHTML(e){if(0!=e.trim().length){rows="",thead="<tr>";var t=Papa.parse(e),o=t.data,a=o.slice(1,o.length);a.sort((function(e,t){return t.length-e.length})),0==a.length&&(a=t.data);var l=0;for(l=0;l<a[0].length;l++)l<o[0].length?thead+="<th>"+o[0][l]+"</th>":thead+="<th>COLUMN"+(l+1)+"</th>";thead+="</tr>";for(var i=1;i<o.length;i++){for(rows+="<tr>",l=0;l<a[0].length;l++)l<o[i].length?rows+="<td>"+o[i][l]+"</td>":rows+="<td>&nbsp</td>";rows+="</tr>"}return htmlOutput("<table border=1><thead>\n"+thead+"</thead><tbody>\n"+rows+"</tbody></table>",ext),old}openErrorDialog("Sorry Input is Empty")}function init(){adsBlocked((function(e){e?$("#ablocker-big").show():$("#ablocker-big").hide()}))}function adsBlocked(e){var t=new Request("https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js",{method:"HEAD",mode:"no-cors"});fetch(t).then((function(e){return e})).then((function(t){console.log(t),e(!1)})).catch((function(t){console.log(t),e(!0)}))}$((function(){postInitEditors(),init()}));