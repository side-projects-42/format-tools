var inputEditor,outputEditor,last_action="beautify",fullscreenEditor="",jeFontSize="16";function createJsonEditor(){if(null==inputEditor&&"json"==document.getElementById("type").value){var t=document.getElementById("inputeditor");(inputEditor=new JSONEditor(t,{mode:"code",onChange:saveChanges,onError:function(t){showErrorDialog("E1 ->"+t.toString())}},null)).aceEditor.setOption("useWorker",!1),inputEditor.aceEditor.setFontSize(jeFontSize+"px");var e=document.getElementById("outputeditor");(outputEditor=new JSONEditor(e,{mode:"code",modes:["code","form","text","tree","view"],onError:function(t){showErrorDialog("E2 ->"+t.toString())},onModeChange:jsoneditormodeChanged},null)).aceEditor.setOption("useWorker",!1),outputEditor.aceEditor.setFontSize(jeFontSize+"px")}addInputIconstoEditor(),addOutputIconstoEditor()}function saveChanges(){null!=inputEditor&&null!=inputEditor.getText()&&0!=inputEditor.getText().length&&saveToLocalStorage(inputEditor.getText()),"json-parser"===$("#viewname").val()&&manageJSONParser()}function manageJSONParser(){beautifyJSON(),outputEditor.setMode("view"),outputEditor.expandAll()}function showErrorDialog(t){document.getElementById("errorMsg").innerHTML=t,document.getElementById("openError").click()}function jsoneditormodeChanged(t,e){if(console.log("newMode:->"+t+" oldMode:->"+e),"code"==t)addOutputIconstoEditor(!0),outputEditor.aceEditor.setFontSize(jeFontSize+"px");else if("text"==t){var o=outputEditor.menu;$(o).append(getOutPutEditorIconsString()),$("#outputcopy").click((function(){copyToClipboard(outputEditor.getText())}))}else if("tree"==t||"form"==t||"view"==t){var i=outputEditor.menu.getElementsByClassName("jsoneditor-search");$(i).before(getMiniOutPutEditorIconsString()),$("#outputcopy").click((function(){copyToClipboard(outputEditor.getText())}))}updateFullScreenIcons("output")}function setDataInInputEditor(t){inputEditor.setText(t)}function addInputIconstoEditor(){var t=inputEditor.menu.getElementsByClassName("jsoneditor-poweredBy");$(t).replaceWith('<div class="btn-group btn-group-sm right hidden-xs"><a href="#" id="sampleDataBtn" title="Sample JSON Data" class="poweredBy" class="samplelink" onclick="loadJSONSampleData();">Sample</a><div id="jsonGraph" class="cursor-pointer btn-sm fa fa-usb" title="JSON Graph" ></div><div id="fileopen" class="cursor-pointer btn-sm fa fa-folder-open" title="Open File" ></div><div class="cursor-pointer btn-sm fa fa-floppy-o" title="Save online" onclick="Action_Save();"></div><div class="cursor-pointer btn-sm fa fa-check" title="JSON Validator" onclick="validateJSON()"></div><div class="cursor-pointer btn-sm fa fa-print" title="Print JSON" onclick="printJson();"></div><div class="cursor-pointer btn-sm fa fa-times" title="Clear" onclick="cleanJSONEditor(\'editor\')"></div><div id="inputcopy" title="Copy to Clipboard" class="cursor-pointer btn-sm btn-shrink fa fa-files-o"></div><div id="inputFullScreen" title="fullscreen" onclick="addOverlay(\'input\');" class="cursor-pointer btn-sm btn-fullscreen fa fa-arrows-alt"></div><div id="inputCloseScreen" title="Close" onclick="removeOverlay(\'input\');" style="display:none" class="cursor-pointer btn-sm btn-fullscreen fa fa-window-close"></div></div>'),$(t).show(),$("#inputcopy").click((function(){copyToClipboard(inputEditor.getText())})),$("#jsonGraph").click((function(){jsonGraph()})),inputEditor.focus()}function addOutputIconstoEditor(t){var e=outputEditor.menu.getElementsByClassName("jsoneditor-poweredBy"),o=outputEditor.menu.getElementsByClassName("modes");$(e).replaceWith(getOutPutEditorIconsString()),t?$(o).show():$(o).hide(),$("#outputcopy").click((function(){copyToClipboard(outputEditor.getText())}))}function getOutPutEditorIconsString(){return'<div id="outputToolBar" class="btn-group btn-group-sm right hidden-xs"><div class="cursor-pointer tree-rotate-180 btn-sm fa fa-tree" title="Tree view" onclick="changeOutputJEtreemode()"></div><div class="cursor-pointer btn-sm fa fa-times" title="Clear" onclick="cleanJSONEditor()"></div><div class="cursor-pointer btn-sm fa fa-download" title="Download" onclick="download();"></div><div id="outputcopy" title="Copy to Clipboard" class="cursor-pointer btn-sm btn-shrink fa fa-files-o"></div><div id="outputFullScreen" title="fullscreen" onclick="addOverlay(\'output\');" class="cursor-pointer btn-sm btn-fullscreen fa fa-arrows-alt"></div><div id="outputCloseScreen" title="Close" onclick="removeOverlay(\'output\');" style="display:none" class="cursor-pointer btn-sm btn-fullscreen fa fa-window-close"></div></div>'}function getMiniOutPutEditorIconsString(){return'<div id="outputToolBar" class="btn-group btn-group-sm right hidden-xs"><div id="outputFullScreen" title="fullscreen" onclick="addOverlay(\'output\');" class="cursor-pointer btn-sm btn-fullscreen fa fa-arrows-alt"></div><div id="outputCloseScreen" title="Close" onclick="removeOverlay(\'output\');" style="display:none" class="cursor-pointer btn-sm btn-fullscreen fa fa-window-close"></div></div>'}function changeOutputJEtreemode(){0==outputEditor.getText().trim().length&&beautifyJSON(),outputEditor.setMode("tree")}function loadJSONSampleData(){if(0!=$("#inputeditor").length){var t=$.parseJSON(getJSonSample());inputEditor.setText(JSON.stringify(t,null,2)),defaultAction()}}function printJson(){hideMessage(),beautifyJSON();var t=inputEditor.getText(),e=$.parseJSON(t);localStorage.setItem("jsondata",JSON.stringify(e,null,2)),$("<iframe>").attr("src","/jsonprint").appendTo("body")}function plainJSONtoXML(){jsonToxml();var t=outputEditor.getText();localStorage.setItem("xmldata",t),window.open("/xmlview","_blank").focus()}function plainJSON(){if(validateJSON()){hideMessage(),beautifyJSON();var t=inputEditor.getText(),e=$.parseJSON(t);localStorage.setItem("jsondata",JSON.stringify(e,null,2)),window.open("/jsonview","_blank").focus()}}function jsonGraph(){if(validateJSON()){hideMessage(),beautifyJSON();var t=inputEditor.getText(),e=$.parseJSON(t);localStorage.setItem("jsondata",JSON.stringify(e,null,2)),window.open("/json-graph","_blank").focus()}}function cleanJSONEditor(t){"editor"==t?(inputEditor.setText(""),saveToLocalStorage(inputEditor.getText())):"all"==t?(inputEditor.setText(""),outputEditor.setText("")):outputEditor.setText("")}function jeOutputtoInput(){if($("#outputToolBar").hide(),0==outputEditor.getText().trim().length)return!1;hideMessage();try{var t=$("#sel1").val(),e=outputEditor.getText(),o=$.parseJSON(e);inputEditor.setText(JSON.stringify(o,null,parseInt(t))),setModelTitle("Formatted JSON")}catch(t){validateJSON()}}function jeInputtoOutput(t){if(null==t&&(t="tree"),0==inputEditor.getText().trim().length)return!1;hideMessage();try{$("#sel1").val();var e=inputEditor.getText();outputEditor.setText(e);$.parseJSON(e);setTimeout((function(){outputEditor.setMode(t),outputEditor.expandAll()}),150),setModelTitle("Formatted JSON")}catch(t){validateJSON()}}function jsonToyaml(t){"object"!=typeof YAML?$.loadScript("dist/js/vendor/yaml.min.js",(function(){processJsonToYaml(t)})):processJsonToYaml(t)}function processJsonToYaml(){if(0==inputEditor.getText().trim().length)return!1;hideMessage();try{var t=inputEditor.getText();json=JSON.parse(t);var e=YAML.stringify(json);outputEditor.setMode("text"),outputEditor.setText(e),setModelTitle("JSON TO YAML")}catch(t){setMessage("error",t)}last_action="jsonToyaml"}function getJSonSample(){return'{"employees":{"employee":[{"id":"1","firstName":"Tom","lastName":"Cruise","photo":"https://jsonformatter.org/img/tom-cruise.jpg"},{"id":"2","firstName":"Maria","lastName":"Sharapova","photo":"https://jsonformatter.org/img/Maria-Sharapova.jpg"},{"id":"3","firstName":"Robert","lastName":"Downey Jr.","photo":"https://jsonformatter.org/img/Robert-Downey-Jr.jpg"}]}}'}function updateJSONOutput(t){null!=inputEditor&&0!=inputEditor.getText().trim().length&&("beautify"==t?beautifyJSON():"minify"==t?minifyJSON():"validateJSON"==t?validateJSON():"jsonToxml"==t?jsonToxml():"jsonTocsv"==t?jsonTocsv():"jsonToyaml"==t&&jsonToyaml())}function beautifyJSON(){if(0==inputEditor.getText().trim().length)return!1;hideMessage();try{var t=$("#sel1").val(),e=inputEditor.getText(),o=$.parseJSON(e);outputEditor.setText(JSON.stringify(o,null,parseInt(t))),outputEditor.setMode("code"),setModelTitle("Formatted JSON")}catch(t){validateJSON()}last_action="beautify"}function validateJSON(){if(0==inputEditor.getText().trim().length)return setMessage("error","Sorry, Input is Empty."),!1;hideMessage(),last_action="validateJSON";try{var t=inputEditor.getText();jsonlint.parse(t);return setMessage("success","VALID JSON",!1),!0}catch(t){return setMessage("error",t),outputEditor.setText(t.message),outputEditor.setMode("text"),!1}}function minifyJSON(){if(0==inputEditor.getText().trim().length)return!1;hideMessage();try{var t=inputEditor.getText(),e=$.parseJSON(t);"code"!=outputEditor.getMode()&&outputEditor.setMode("code"),outputEditor.setText(JSON.stringify(e,null,0)),setModelTitle("Minified JSON")}catch(t){validateJSON()}last_action="minify"}function loadCSVProcessFiles(){$.getScript("js/tools/convertToJava.js")}function jsonTocsv(t){if("function"==typeof jsonToCsv)return processJSONtoCSV(t);$.loadScript("dist/js/vendor/converttocsv-underscore-lib.js",(function(){jsonTocsv(t)}))}function processJSONtoCSV(t){if(0==inputEditor.getText().trim().length)return!1;hideMessage();try{var e=jsonlint.parse(inputEditor.getText()),o=jsonToCsv(e,",",!0,!1,!1);if(void 0!==t&&1==t)return o;outputEditor.setMode("text"),outputEditor.setText(o),setModelTitle("JSON TO CSV")}catch(t){console.log(t),validateJSON()}last_action="jsonTocsv"}function jsonToxml(){if(0==inputEditor.getText().trim().length)return!1;hideMessage();try{if("function"!=typeof XML)return void $.loadScript("dist/js/vendor/ObjTree.js",jsonToxml);var t=inputEditor.getText().replace(/([ :$&]+)(?=[(\w* *]*":)/g,"_"),e=jsonlint.parse(t),o=(new XML.ObjTree).writeXML(e);o=decodeSpecialCharacter(o),outputEditor.setMode("text"),outputEditor.setText(vkbeautify.xml(o)),setModelTitle("JSON TO XML")}catch(t){console.log(t)}last_action="jsonToxml"}function plainJSONtoCSV(){jsonTocsv();var t=outputEditor.getText();localStorage.setItem("data",t),window.open("/csvview","_blank").focus()}function plainJSONtoYAML(){jsonToyaml();var t=outputEditor.getText();localStorage.setItem("data",t),window.open("/yamlview","_blank").focus()}function jsonTotsv(){outputEditor.setMode("text");var t=jsonTocsv(!0),e=getCSVTOTSV(t);outputEditor.setText(e),setModelTitle("JSON TO TSV"),last_action="jsonTotsv"}function plainJSONtoTSV(){jsonTotsv();var t=outputEditor.getText();localStorage.setItem("data",t),window.open("/tsvview","_blank").focus()}function jsonToHtml(){outputEditor.setMode("text");var t=jsonTocsv(!0);outputEditor.setText(toHTML(t)),setModelTitle("JSON TO HTML"),last_action="jsonTohtml"}function jsonToJava(){outputEditor.setMode("text");var t=inputEditor.getText().replace(/([ :$&]+)(?=[(\w* *]*":)/g,"_"),e=createJavaObject(t);outputEditor.setText(e),setModelTitle("JSON TO Java"),last_action="jsonToJava"}function plainJSONtoJava(){jsonToJava(),localStorage.setItem("data",outputEditor.getText()),window.open("/javaview","_blank").focus()}function jsonEncode(){outputEditor.setMode("text"),outputEditor.setText(JSON.stringify(inputEditor.getText())),setModelTitle("JSON Encode"),last_action="jsonEncode"}function jsonDecode(){outputEditor.setMode("text"),outputEditor.setText(JSON.parse(inputEditor.getText())),setModelTitle("JSON Decode"),last_action="jsonDecode"}function jsonToStringConverter(){var t=jsonToString(JSON.parse(inputEditor.getText()));outputEditor.setText(t),setModelTitle("JSON String"),last_action="jsonString"}function jsonToString(t){var e="";if("object"==typeof t)if(t instanceof Array)for(var o in t)e+=jsonToString(t[o]);else for(var o in t){var i=t[o];e+="object"==typeof i?o+"\n"+jsonToString(i):o+" "+jsonToString(i)}else e+=t.toString()+"\n";return e}function jsonStringifyOnline(){var t=JSON.stringify(inputEditor.getText());outputEditor.setText(t),setModelTitle("JSON Stringify"),last_action="jsonStringify"}